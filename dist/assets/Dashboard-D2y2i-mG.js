import{c as b,j as e,L as v,r as x,u as M}from"./index-B_kjqxqP.js";import{u,C as f,a as h,b as g,B as k,c as p,d as j,M as E}from"./Card-wIzGCNSu.js";import{B as N}from"./Button-Dwa1UsuP.js";import{C as A}from"./check-circle-BinmyBnw.js";import{N as R}from"./NotificationCard-BPSxdROC.js";import{C as T}from"./clock-eVRuqhUy.js";import{I as q}from"./Input-aZjQaUej.js";import{S as y}from"./Select-DB7_T4-b.js";import"./ThemeToggle-DxtfPcVw.js";import"./cn-BNf5BS2b.js";import"./home-CIpEbKz-.js";import"./formatters-CWHgbahH.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=b("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=b("SendHorizontal",[["path",{d:"m3 3 3 9-3 9 19-9Z",key:"1aobqy"}],["path",{d:"M6 12h16",key:"s4cdu5"}]]),L=()=>{const{notifications:t,readNotifications:o}=u(),a=t.length,i=o.length,n=a-i,r={general:t.filter(s=>s.category==="general").length,emergency:t.filter(s=>s.category==="emergency").length,mess:t.filter(s=>s.category==="mess").length,maintenance:t.filter(s=>s.category==="maintenance").length,events:t.filter(s=>s.category==="events").length};let c="general",d=0;return Object.entries(r).forEach(([s,m])=>{m>d&&(c=s,d=m)}),e.jsxs(f,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center",children:[e.jsx(k,{className:"mr-2 h-5 w-5 text-primary"}),"Notification Summary"]})}),e.jsxs(p,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center p-4 bg-secondary/50 rounded-lg",children:[e.jsx(z,{className:"h-8 w-8 text-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:a})]}),e.jsxs("div",{className:"flex flex-col items-center p-4 bg-secondary/50 rounded-lg",children:[e.jsx(A,{className:"h-8 w-8 text-success mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Read"}),e.jsx("p",{className:"text-2xl font-bold",children:i})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Notification Stats"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Unread"}),e.jsx("span",{className:"text-sm font-medium",children:n})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Most common category"}),e.jsxs("span",{className:"text-sm font-medium capitalize",children:[c," (",d,")"]})]}),e.jsx("div",{className:"w-full bg-secondary h-2 rounded-full mt-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:`${i/a*100}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:[Math.round(i/a*100),"% read rate"]})]})]})]}),e.jsx(j,{children:e.jsx(v,{to:"/notifications",className:"w-full",children:e.jsx(N,{className:"w-full",variant:"outline",children:"View All Notifications"})})})]})},B=()=>{const{notifications:t,readNotifications:o,markAsRead:a}=u(),i=[...t].sort((r,c)=>new Date(c.createdAt).getTime()-new Date(r.createdAt).getTime()).slice(0,3),n=async r=>{await a(r)};return e.jsxs(f,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center",children:[e.jsx(T,{className:"mr-2 h-5 w-5 text-primary"}),"Recent Notifications"]})}),e.jsx(p,{children:e.jsx("div",{className:"space-y-4",children:i.length>0?i.map(r=>e.jsx(R,{notification:r,readNotifications:o,onMarkAsRead:n,isCompact:!0},r.id)):e.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"No notifications yet"})})}),e.jsx(j,{children:e.jsx(v,{to:"/notifications",className:"w-full",children:e.jsx(N,{className:"w-full",variant:"outline",children:"View All"})})})]})},D=({onSubmit:t,isLoading:o=!1})=>{const[a,i]=x.useState(""),[n,r]=x.useState(""),[c,d]=x.useState("general"),[s,m]=x.useState("medium"),w=[{value:"general",label:"General"},{value:"emergency",label:"Emergency"},{value:"mess",label:"Mess"},{value:"maintenance",label:"Maintenance"},{value:"events",label:"Events"}],C=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],S=async l=>{l.preventDefault(),!(!a||!n)&&(await t({title:a,message:n,category:c,priority:s}),i(""),r(""),d("general"),m("medium"))};return e.jsxs(f,{children:[e.jsx(h,{children:e.jsxs(g,{className:"flex items-center",children:[e.jsx(H,{className:"mr-2 h-5 w-5 text-primary"}),"Create Notification"]})}),e.jsxs("form",{onSubmit:S,children:[e.jsxs(p,{className:"space-y-4",children:[e.jsx(q,{label:"Title",id:"title",value:a,onChange:l=>i(l.target.value),required:!0,placeholder:"Notification title"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(y,{label:"Category",id:"category",options:w,value:c,onChange:l=>d(l),required:!0}),e.jsx(y,{label:"Priority",id:"priority",options:C,value:s,onChange:l=>m(l),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-foreground mb-2",children:"Message"}),e.jsx("textarea",{id:"message",rows:5,value:n,onChange:l=>r(l.target.value),required:!0,placeholder:"Enter the notification message...",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),e.jsx(j,{children:e.jsx(N,{type:"submit",className:"w-full",isLoading:o,children:"Send Notification"})})]})]})},Q=()=>{const{user:t}=M(),{fetchNotifications:o,createNotification:a}=u();x.useEffect(()=>{o()},[o]);const i=async n=>{await a(n)};return e.jsx(E,{title:`Welcome, ${t==null?void 0:t.name}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Hostel Notification System"}),e.jsx("p",{className:"text-muted-foreground",children:(t==null?void 0:t.role)==="warden"?"Manage and send notifications to students. Monitor engagement and ensure all important information is delivered effectively.":"Stay updated with all hostel announcements and notifications. Never miss important updates."})]}),e.jsx(B,{})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(L,{}),(t==null?void 0:t.role)==="warden"&&e.jsx(D,{onSubmit:i})]})]})})};export{Q as default};
