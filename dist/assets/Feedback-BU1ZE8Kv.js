import{c as y,r as c,j as e,m as u,d as N,u as S}from"./index-B_kjqxqP.js";import{C as x,a as h,b as f,f as g,c as p,M as v}from"./Card-wIzGCNSu.js";import{B as w}from"./Button-Dwa1UsuP.js";import{S as k}from"./Select-DB7_T4-b.js";import{f as F}from"./formatters-CWHgbahH.js";import{C}from"./check-circle-BinmyBnw.js";import"./ThemeToggle-DxtfPcVw.js";import"./cn-BNf5BS2b.js";import"./home-CIpEbKz-.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=y("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),I=({onSubmit:s,isLoading:o=!1})=>{const[t,i]=c.useState("mess"),[a,r]=c.useState(5),[d,l]=c.useState(""),j=async n=>{n.preventDefault(),await s({category:t,rating:a,comment:d}),l(""),r(5)};return e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(f,{className:"flex items-center",children:[e.jsx(g,{className:"mr-2 h-5 w-5 text-primary"}),"Submit Feedback"]})}),e.jsx(p,{children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsx(k,{label:"Category",options:[{value:"mess",label:"Mess Food"},{value:"facilities",label:"Facilities"}],value:t,onChange:n=>i(n)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Rating"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(n=>e.jsx(u.button,{type:"button",whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>r(n),className:`p-2 rounded-full transition-colors ${n<=a?"text-warning":"text-muted-foreground"}`,children:e.jsx(b,{size:24,fill:n<=a?"currentColor":"none"})},n))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Comment"}),e.jsx("textarea",{value:d,onChange:n=>l(n.target.value),required:!0,placeholder:"Share your feedback...",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 min-h-[100px]"})]}),e.jsx(w,{type:"submit",className:"w-full",isLoading:o,children:"Submit Feedback"})]})})]})},L=({feedbacks:s,isLoading:o=!1})=>o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-primary border-r-transparent"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Loading feedback..."})]}):s.length===0?e.jsxs("div",{className:"text-center py-12 bg-card rounded-lg border border-border",children:[e.jsx(g,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"No feedback yet"})]}):e.jsx("div",{className:"space-y-4",children:s.map((t,i)=>e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:i*.1},children:e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(f,{className:"capitalize text-lg",children:[t.category," Feedback"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:F(t.createdAt)})]}),e.jsx("div",{className:"flex items-center space-x-1",children:[...Array(5)].map((a,r)=>e.jsx(b,{size:16,className:"text-warning",fill:r<t.rating?"currentColor":"none"},r))})]})}),e.jsxs(p,{children:[e.jsx("p",{className:"text-foreground",children:t.comment}),t.resolved&&e.jsxs("div",{className:"mt-4 p-3 bg-success/10 rounded-md",children:[e.jsxs("div",{className:"flex items-center text-success mb-2",children:[e.jsx(C,{size:16,className:"mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Resolved"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.response})]})]})]})},t.id))}),m=[{id:"1",category:"mess",rating:4,comment:"The food quality has improved significantly this month.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),userId:"student-1",hostelId:"hostel-1"},{id:"2",category:"facilities",rating:3,comment:"The gym equipment needs maintenance.",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),userId:"student-1",hostelId:"hostel-1",resolved:!0,response:"Maintenance team has been notified and will fix the equipment this week."}],A=N((s,o)=>({feedbacks:[],isLoading:!1,createFeedback:async t=>{s({isLoading:!0}),await new Promise(a=>setTimeout(a,800));const i={id:`feedback-${Date.now()}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),userId:"student-1",hostelId:"hostel-1",...t};return s(a=>({feedbacks:[i,...a.feedbacks],isLoading:!1})),i},fetchFeedbacks:async()=>(s({isLoading:!0}),await new Promise(t=>setTimeout(t,800)),s({feedbacks:m,isLoading:!1}),m),resolveFeedback:async(t,i)=>{s({isLoading:!0}),await new Promise(a=>setTimeout(a,500)),s(a=>({feedbacks:a.feedbacks.map(r=>r.id===t?{...r,resolved:!0,response:i,updatedAt:new Date().toISOString()}:r),isLoading:!1}))}})),B=()=>{const{user:s}=S(),{feedbacks:o,isLoading:t,createFeedback:i,fetchFeedbacks:a}=A();c.useEffect(()=>{a()},[a]);const r=async d=>{await i(d)};return e.jsx(v,{title:"Feedback",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(L,{feedbacks:o,isLoading:t})}),(s==null?void 0:s.role)==="student"&&e.jsx("div",{children:e.jsx(I,{onSubmit:r,isLoading:t})})]})})};export{B as default};
